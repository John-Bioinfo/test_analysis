#!/usr/bin/env python36
# -*- coding: UTF-8 -*-

from dna_features_viewer import GraphicFeature, GraphicRecord


startP = 29909037
seq =  '''AAGGGGAGAGGAGGGCCTGAAGGATGAGAAGGATGGAGGGAAGGGCTGGA
GAAGCAGGAGGTGAGGAAAAGGAGCAGAGGAAAGAATTTGAAAGCAGCAG
AATTCTTAGGTTTAAAGACATTGTTTTATGGATTTTAATACATCAATCTA
CAGAGCCTAGGAGGGTGTCCTTGGCAGTTGTCTTTTAATACCTCATGTGG
GTCTGCCTAAAAACTATTTTTTATGTTAATCAGGTTTAAAAATTACTAAG
TGTTCCTATAAAATATACACAACACTTAGAAGTGGATACTTCCTAAAAAC
AGGCAGTGCATGAGCACTAGTGAGGGGCATTGTGACTGCCTTGAACAGTT
GCAACTTTGAGGTGAATAAAGCCTGTAATGGCTTCTGGTTGCAACATATA
GGAACACAGTGGCTACTTTGTATTGAGGAGATGTCGTGGACTCACACAGA
AACTCAGAGCTAAGGAATGATGGCAAATTTAAAGTAAGACAAGCAGGAGT
CACAGATACATTGTCTGGGAAAGTGCAACTTAGTAGCTTTGTGAGTCCTG
TTGTAATGCTTTTGGACACATTTATACATTAAGGGGCCAAAGTCACATTT
TTTACCTATTAGATTCCTGATCATTCAGGGGTTACCAAGATTCTGCTACC
CACTGTAGTTAATAAACAAAGAGCAAATTGGTCTCTATTCTGTCTCATGC
ACTCAGGCACAACTTTTCCGGATTAAAAACAAAAACAACAACAACAAAAA
TCTACACCTCCATTCCCAGATCAAGCTTACTCTCTGGCACCAAACTCCAT
GGGGTGATTTTTCTTCTAGAAGAGTCCAGGTGGACAGGTAAGGAGTGGGA
GTCAGGGAGTCCAGTTCAGGGACAGAGATAATGGGATGAAAAGTGAAAGG
AGAGGGACGGGGCCCATGCCGAGGGTTTCTCCCTTGTTTCTCAGACAGCT
CCTGGGCCAAGACTCAGGGAGACATTGAGACAGAGCGCTTCGCACAGGAG
CAGAGGGGTCAGGGCGAAGTCCCAGGGCCCCAGGCGTGGCTCTCAGAGTC
TCAGGCCCCGAAGGCGGTGTATGGATTGGGGAGTCCCAGCCTTGGGGATT
CCCCAACTCCGCAGTTTCTTTTCTCCCTCTCCCAACCTACGTAGGGTCCT
TCATCCTGGATACTCACGACGCGGACCCAGTTCTCACTCCCATTGGGTGT
CGGGTTTCCAGAGAAGCCAATCAGTGTCGTCGCGGTCGCTGTTCTAAAGC
CCGCACGCACCCACCGGGACTCAGATTCTCCCCAGACGCCGAGGATGGCC
GTCATGGCGCCCCGAACCCTCCTCCTGCTACTCTCGGGGGCCCTGGCCCT
GACCCAGACCTGGGCGGGTGAGTGCGGGGTCGGGAGGGAAACCGCCTCTG
CGGGGAGAAGCAAGGGGCCCTCCTGGCGGGGGCGCAGGACCGGGGGAGCC
GCGCCGGGACGAGGGTCGGGCAGGTCTCAGCCACTGCTCGCCCCCAGGCT
CCCACTCCATGAGGTATTTCTTCACATCCGTGTCCCGGCCCGGCCGCGGG
GAGCCCCGCTTCATCGCCGTGGGCTACGTGGACGACACGCAGTTCGTGCG
GTTCGACAGCGACGCCGCGAGCCAGAGGATGGAGCCGCGGGCGCCGTGGA
TAGAGCAGGAGGGGCCGGAGTATTGGGACCAGGAGACACGGAATGTGAAG
GCCCAGTCACAGACTGACCGAGTGGACCTGGGGACCCTGCGCGGCTACTA
CAACCAGAGCGAGGCCGGTGAGTGACCCCGGCCGGGGGCGCAGGTCAGGA
CCCCTCATCCCCCACGGACGGGCCAGGTCGCCCACAGTCTCCGGGTCCGA
GATCCACCCCGAAGCCGCGGGACCCCGAGACCCTTGCCCCGGGAGAGGCC
CAGGCGCCTTTACCCGGTTTCATTTTCAGTTTAGGCCAAAAATCCCCCCG
GGTTGGTCGGGGCTGGGCGGGGCTCGGGGGACTGGGCTGACCGCGGGGTC
GGGGCCAGGTTCTCACACCATCCAGATAATGTATGGCTGCGACGTGGGGT
CGGACGGGCGCTTCCTCCGCGGGTACCGGCAGGACGCCTACGACGGCAAG
GATTACATCGCCCTGAACGAGGACCTGCGCTCTTGGACCGCGGCGGACAT
GGCGGCTCAGATCACCAAGCGCAAGTGGGAGGCGGCCCATGAGGCGGAGC
AGTTGAGAGCCTACCTGGATGGCACGTGCGTGGAGTGGCTCCGCAGATAC
CTGGAGAACGGGAAGGAGACGCTGCAGCGCACGGGTACCAGGGGCCACGG
GGCGCCTCCCTGATCGCCTGTAGATCTCCCGGGCTGGCCTCCCACAAGGA
GGGGAGACAATTGGGACCAACACTAGAATATCACCCTCCCTCTGGTCCTG
AGGGAGAGGAATCCTCCTGGGTTCCAGATCCTGTACCAGAGAGTGACTCT
GAGGTTCCGCCCTGCTCTCTGACACAATTAAGGGATAAAATCTCTGAAGG
AGTGACGGGAAGACGATCCCTCGAATACTGATGAGTGGTTCCCTTTGACA
CCGGCAGCAGCCTTGGGCCCGTGACTTTTCCTCTCAGGCCTTGTTCTCTG
CTTCACACTCAATGTGTGTGGGGGTCTGAGTCCAGCACTTCTGAGTCCCT
CAGCCTCCACTCAGGTCAGGACCAGAAGTCGCTGTTCCCTTCTCAGGGAA
TAGAAGATTATCCCAGGTGCCTGTGTCCAGGCTGGTGTCTGGGTTCTGTG
CTCTCTTCCCCATCCCGGGTGTCCTGTCCATTCTCAAGATGGCCACATGC
GTGCTGGTGGAGTGTCCCATGACAGATGCAAAATGCCTGAATTTTCTGAC
TCTTCCCGTCAGACCCCCCCAAGACACATATGACCCACCACCCCATCTCT
GACCATGAGGCCACCCTGAGGTGCTGGGCCCTGGGCTTCTACCCTGCGGA
GATCACACTGACCTGGCAGCGGGATGGGGAGGACCAGACCCAGGACACGG
AGCTCGTGGAGACCAGGCCTGCAGGGGATGGAACCTTCCAGAAGTGGGCG
GCTGTGGTGGTGCCTTCTGGAGAGGAGCAGAGATACACCTGCCATGTGCA
GCATGAGGGTCTGCCCAAGCCCCTCACCCTGAGATGGGGTAAGGAGGGAG
ATGGGGGTGTCATGTCTCTTAGGGAAAGCAGGAGCCTCTCTGGAGACCTT
TAGCAGGGTCAGGGCCCCTCACCTTCCCCTCTTTTCCCAGAGCTGTCTTC
CCAGCCCACCATCCCCATCGTGGGCATCATTGCTGGCCTGGTTCTCCTTG
GAGCTGTGATCACTGGAGCTGTGGTCGCTGCCGTGATGTGGAGGAGGAAG
AGCTCAGGTGGAGAAGGGGTGAAGGGTGGGGTCTGAGATTTCTTGTCTCA
CTGAGGGTTCCAAGCCCCAGCTAGAAATGTGCCCTGTCTCATTACTGGGA
AGCACCGTCCACAATCATGGGCCTACCCAGTCTGGGCCCTGTGTGCCAGC
ACTTACTCTTTTGTAAAGCACCTGTTAAAATGAAGGACAGATTTATCACC
TTGATTACGGCGGTGATGGGACCTGATCCCAGCAGTCACAAGTCACAGGG
GAAGGTCCCTGAGGACAGACCTCAGGAGGGCTATTGGTCCAGGACCCACA
CCTGCTTTCTTCATGTTTCCTGATCCCGCCCTGGGTCTGCAGTCACACAT
TTCTGGAAACTTCTCTGGGGTCCAAGACTAGGAGGTTCCTCTAGGACCTT
AAGGCCCTGGCTCCTTTCTGGTATCTCACAGGACATTTTCTTCTCACAGA
TAGAAAAGGAGGGAGTTACACTCAGGCTGCAAGTAAGTATGAAGGAGGCT
GATGCCTGAGGTCCTTGGGATATTGTGTTTGGGAGCCCATGGGGGAGCCC
ACCCACCTCACAATTCCTCCTCTAGCCACATCTTCTGTGGGATCTGACCA
GGTTCTGTTTTTGTTCTACCCCAGGCAGTGACAGTGCCCAGGGCTCTGAT
GTGTCCCTCACAGCTTGTAAAGGTGAGAGCTTGGAGGACCTAATGTGTGT
TGGGTGTTGGGCGGAACAGTGGACACAGCTGTGCTATGGGGTTTCTTTGC
ATTGGATGTATTGAGCATGCGATGGGCTGTTTAAGGTGTGACCCCTCACT
GTGATGGATATGAATTTGTTCATGAATATTTTTTTCTATAGTGTGAGACA
GCTGCCTTGTGTGGGACTGAGAGGCAAGAGTTGTTCCTGCCCTTCCCTTT
GTGACTTGAAGAACCCTGACTTTGTTTCTGCAAAGGCACCTGCATGTGTC
TGTGTTCGTGTAGGCATAATGTGAGGAGGTGGGGAGACCACCCCACCCCC
ATGTCCACCATGACCCTCTTCCCACGCTGACCTGTGCTCCCTCCCCAATC
ATCTTTCCTGTTCCAGAGAGGTGGGGCTGAGGTGTCTCCATCTCTGTCTC
AACTTCATGGTGCACTGAGCTGTAACTTCTTCCTTCCCTATTAAAATTAG
AACCTTAGTATAAATTTACTTTCTCAAATTCTTGCCATGAGAGGTTGATG
AGTTAATTAAAGGAGAAGATTCCTAAAATTTGAGAGACAAAATAAATGGA
AGACATGAGAACCTTCCAGAGTCCA'''

inputA = 'hla_test.bed' 
seqFeat = []

fileH = open(inputA, 'r')
for line in fileH:
    x = line.rstrip().split('\t')
    chrName = x[0]

    s = int(x[1]) - startP
    e = int(x[2]) - startP

    seqFeat.append(GraphicFeature(start = s, end = e+1, strand=+1, color='#330066' ))
fileH.close()
#record = GraphicRecord(sequence= seq.replace('\n', ''),  features= seqFeat)
record = GraphicRecord(sequence_length= len(seq.replace('\n', '')),  features= seqFeat)

#ax,_ = record.plot(figure_width= 120)
ax,_ = record.plot(figure_width= 18)
#record.plot_sequence(ax)
record.plot(ax)
ax.figure.savefig('Gene_sequence_hlaA.png', bbox_inches='tight')
